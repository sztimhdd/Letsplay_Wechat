# 足球活动组织小程序

## 1. 产品概述
这是一个基于微信小程序的足球活动组织工具，用于管理和组织足球活动。系统使用 Google Sheets 作为后端数据存储，实现轻量级的活动管理。

## 2. 核心功能

### 2.1 活动列表（首页）
- 以卡片形式展示所有活动
- 显示活动基本信息：日期、时间、场地、人数、人均费用
- 支持下拉刷新更新活动列表
- 悬浮按钮用于创建新活动
- 活动卡片点击可进入详情页

### 2.2 活动创建
- 表单字段：
  * 活动日期（日期选择器）
  * 时间段（时间选择器：开始时间-结束时间）
  * 场地编号（数字输入）
  * 人数上限（数字输入，默认16人）
  * 场地费用（数字输入）
- 数据写入规则：
  * 在 Google Sheet 的 Record 表中插入新列（F列）
  * 原有活动数据自动右移
  * 活动基本信息写入 F2:F5 单元格
  * F6 及以下保留空白，用于后续签到数据

### 2.3 活动详情
- 显示活动完整信息
- 展示参与者列表和签到状态
- 支持活动费用结算
- 显示每人应付金额

### 2.4 数据存储结构
Google Sheets 包含多个表：
1. Record 表：
   - A-E列：固定用户信息（姓名、微信号、押金、余额、年度消费）
   - F列及之后：活动记录
   - 每个活动占用一列，包含：
     * 日期（第2行）
     * 场地信息（第3行，格式：X号场 - XX人）
     * 时间段（第4行，格式：HH:mm-HH:mm）
     * 总费用（第5行）
     * 第6行及以下：参与者费用记录

2. Deposit Record 表：押金记录
3. Feecalcu 表：费用计算

## 3. 数据刷新机制
- 创建活动后自动刷新全局数据
- 返回首页时自动刷新活动列表
- 支持手动下拉刷新
- 活动详情页进入时刷新数据

## 4. 用户体验优化
- 表单提交时显示加载状态
- 操作成功后显示反馈提示
- 数据加载时显示加载动画
- 错误发生时显示友好提示

## 5. 错误处理
- 表单输入验证
- API 请求错误处理
- 数据写入验证
- 网络异常处理

## 6. 安全性
- 管理员功能需要密码验证
- 用户数据安全存储
- API 访问令牌管理

## 7. 后续规划
- 活动报名功能
- 用户余额管理
- 活动数据统计
- 自动费用计算
- 签到功能优化

我需要在微信平台上开发一个帮助用户管理体育活动包场报名和结算功能的微信小程序。

用户分为场次管理员和普通球友，场次管理员可以创建活动，普通球友可以报名活动。

1. 场次管理员可以创建活动，并设置活动规则，包括场地地址、报名人数、活动日期时间、活动总费用等。
2. 普通球友可以报名活动。
3. 场次管理员可以查看活动报名情况。
4. 普通球友可以查看活动报名情况，并取消报名。
5. 场次管理员可以在活动结束后，对报名球友进行统一的签到确认，然后系统自动计算出每人应缴纳的AA金额，并进行余额结算。
6. 普通球友可以在活动结束后，查看活动费用及人均AA的金额，并查看自己的余额。
7. 普通球友可以查看自己所有场次的报名、签到和付费情况。

普通球友的用户界面包括：
1. 首页：显示当前可报名的活动列表，空位/已报名人数，活动日期/时间/时长，点击进入活动详情页。首页上有一个添加活动的按钮，点击后提示输入管理员密码（事先定义好），确认后进入活动创建页面。
2. 活动详情页：显示活动详情，包括场地地址、报名人数、活动日期时间、活动总费用、人均AA的金额。下方有一个结算签到按钮，点击后提示输入管理员密码（事先定义好），确认后进入参与人员签到及费用结算页面。
2.1 下方有"立即报名"按钮，点击后完成报名，并跳转到报名成功页。活动开始前2小时不能报名。活动开始后不能取消报名。
2.3 如果当前活动已结束且用户报名了该活动，则有该次活动的费用详情，包括人均AA的金额，以及用户自己的费用，以及余额。
4. 报名成功页：显示报名成功，并跳转到首页。
6. 我的活动页：上方大字体显示我的余额，下方列表是所有我报名的活动列表，点击进入该次活动详情页（见2）。

场次管理员的用户界面包括：
1. 首页：同普通用户，通过点击"添加活动按钮"后输入密码可以进入活动创建页面。
2. 活动详情页：同普通用户，下方有一个"赛后结算"按钮，点击后进入参与人员签到及费用结算页面。
2.2 场次管理员的详情页比普通球友的详情页多一个"取消活动"按钮，点击后删除该次活动。此操作需要管理员二次确认。
3. 签到及费用结算页面：列出所有报名用户，后面有一个"签到"按钮，管理员可以点击"签到"按钮，完成签到。签到页面下方有一个"费用结算"按钮，点击后进入费用结算页面。
4. 费用结算页面：列出所有报名且已签到用户，列出其应缴纳的AA金额，以及缴纳后的充值余额, 还有一个此次活动充值金额的输入框。点击下方的确认按钮则更新后台的全部用户余额数据。此操作需要管理员二次确认。
5. 余额管理页面：列出所有用户，以及其当前余额。可以在此页面手动调整用户的余额。

程序采用无后端设计，所有用户对活动数据的操作都直接通过Google Sheet API在Google Sheet中进行。Google Sheet的API key事先在Google Cloud中配置好，并写入小程序的代码中。



